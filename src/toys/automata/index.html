<!DOCTYPE html>
<html>
	<head>
		<title>by Dom Mandy</title>
		<meta name="description" content="shit tin" />
		<meta name="keywords" content="Dom, Mandy" />
		<link href="favicon.ico" rel="shortcut icon" />
		<style>
			* {
				padding: 0;
				margin: 0;
				overflow: hidden;
			}
			canvas {
				width: 100vw;
				height: 100vh;
			}
		</style>
	</head>
	<body>
		<canvas width="840" height="720">
			<script>
				;(function () {
					function f(a) {
						var c = [],
							b = Math.pow(a + 16, 3) / 1560896
						b = b > g ? b : a / k
						for (var d = 0; 3 > d; ) {
							var e = d++,
								h = l[e][0],
								w = l[e][1]
							e = l[e][2]
							for (var x = 0; 2 > x; ) {
								var y = x++,
									z = (632260 * e - 126452 * w) * b + 126452 * y
								c.push({
									b: ((284517 * h - 94839 * e) * b) / z,
									a:
										((838422 * e + 769860 * w + 731718 * h) * a * b -
											769860 * y * a) /
										z,
								})
							}
						}
						return c
					}
					function m(a) {
						a = f(a)
						for (var c = Infinity, b = 0; b < a.length; ) {
							var d = a[b]
							++b
							c = Math.min(c, Math.abs(d.a) / Math.sqrt(Math.pow(d.b, 2) + 1))
						}
						return c
					}
					function n(a, c) {
						c = (c / 360) * Math.PI * 2
						a = f(a)
						for (var b = Infinity, d = 0; d < a.length; ) {
							var e = a[d]
							++d
							e = e.a / (Math.sin(c) - e.b * Math.cos(c))
							0 <= e && (b = Math.min(b, e))
						}
						return b
					}
					function p(a, c) {
						for (var b = 0, d = 0, e = a.length; d < e; ) {
							var h = d++
							b += a[h] * c[h]
						}
						return b
					}
					function q(a) {
						return 0.0031308 >= a
							? 12.92 * a
							: 1.055 * Math.pow(a, 0.4166666666666667) - 0.055
					}
					function r(a) {
						return 0.04045 < a ? Math.pow((a + 0.055) / 1.055, 2.4) : a / 12.92
					}
					function t(a) {
						return [q(p(l[0], a)), q(p(l[1], a)), q(p(l[2], a))]
					}
					function u(a) {
						a = [r(a[0]), r(a[1]), r(a[2])]
						return [p(v[0], a), p(v[1], a), p(v[2], a)]
					}
					function A(a) {
						var c = a[0],
							b = a[1]
						a = c + 15 * b + 3 * a[2]
						0 != a ? ((c = (4 * c) / a), (a = (9 * b) / a)) : (a = c = NaN)
						b =
							b <= g
								? (b / B) * k
								: 116 * Math.pow(b / B, 0.3333333333333333) - 16
						return 0 == b ? [0, 0, 0] : [b, 13 * b * (c - C), 13 * b * (a - D)]
					}
					function E(a) {
						var c = a[0]
						if (0 == c) return [0, 0, 0]
						var b = a[1] / (13 * c) + C
						a = a[2] / (13 * c) + D
						c = 8 >= c ? (B * c) / k : B * Math.pow((c + 16) / 116, 3)
						b = 0 - (9 * c * b) / ((b - 4) * a - b * a)
						return [b, c, (9 * c - 15 * a * c - a * b) / (3 * a)]
					}
					function F(a) {
						var c = a[0],
							b = a[1],
							d = a[2]
						a = Math.sqrt(b * b + d * d)
						1e-8 > a
							? (b = 0)
							: ((b = (180 * Math.atan2(d, b)) / Math.PI),
							  0 > b && (b = 360 + b))
						return [c, a, b]
					}
					function G(a) {
						var c = a[1],
							b = (a[2] / 360) * 2 * Math.PI
						return [a[0], Math.cos(b) * c, Math.sin(b) * c]
					}
					function H(a) {
						var c = a[0],
							b = a[1]
						a = a[2]
						if (99.9999999 < a) return [100, 0, c]
						if (1e-8 > a) return [0, 0, c]
						b = (n(a, c) / 100) * b
						return [a, b, c]
					}
					function I(a) {
						var c = a[0],
							b = a[1]
						a = a[2]
						if (99.9999999 < c) return [a, 0, 100]
						if (1e-8 > c) return [a, 0, 0]
						var d = n(c, a)
						return [a, (b / d) * 100, c]
					}
					function J(a) {
						var c = a[0],
							b = a[1]
						a = a[2]
						if (99.9999999 < a) return [100, 0, c]
						if (1e-8 > a) return [0, 0, c]
						b = (m(a) / 100) * b
						return [a, b, c]
					}
					function K(a) {
						var c = a[0],
							b = a[1]
						a = a[2]
						if (99.9999999 < c) return [a, 0, 100]
						if (1e-8 > c) return [a, 0, 0]
						var d = m(c)
						return [a, (b / d) * 100, c]
					}
					function L(a) {
						for (var c = '#', b = 0; 3 > b; ) {
							var d = b++
							d = Math.round(255 * a[d])
							var e = d % 16
							c += M.charAt(((d - e) / 16) | 0) + M.charAt(e)
						}
						return c
					}
					function N(a) {
						a = a.toLowerCase()
						for (var c = [], b = 0; 3 > b; ) {
							var d = b++
							c.push(
								(16 * M.indexOf(a.charAt(2 * d + 1)) +
									M.indexOf(a.charAt(2 * d + 2))) /
									255
							)
						}
						return c
					}
					function O(a) {
						return t(E(G(a)))
					}
					function P(a) {
						return F(A(u(a)))
					}
					function Q(a) {
						return O(H(a))
					}
					function R(a) {
						return I(P(a))
					}
					function S(a) {
						return O(J(a))
					}
					function T(a) {
						return K(P(a))
					}
					var l = [
							[3.240969941904521, -1.537383177570093, -0.498610760293],
							[-0.96924363628087, 1.87596750150772, 0.041555057407175],
							[0.055630079696993, -0.20397695888897, 1.056971514242878],
						],
						v = [
							[0.41239079926595, 0.35758433938387, 0.18048078840183],
							[0.21263900587151, 0.71516867876775, 0.072192315360733],
							[0.019330818715591, 0.11919477979462, 0.95053215224966],
						],
						B = 1,
						C = 0.19783000664283,
						D = 0.46831999493879,
						k = 903.2962962,
						g = 0.0088564516,
						M = '0123456789abcdef'
					window.hsluv = {
						hsluvToRgb: Q,
						rgbToHsluv: R,
						hpluvToRgb: S,
						rgbToHpluv: T,
						hsluvToHex: function (a) {
							return L(Q(a))
						},
						hexToHsluv: function (a) {
							return R(N(a))
						},
						hpluvToHex: function (a) {
							return L(S(a))
						},
						hexToHpluv: function (a) {
							return T(N(a))
						},
						lchToHpluv: K,
						hpluvToLch: J,
						lchToHsluv: I,
						hsluvToLch: H,
						lchToLuv: G,
						luvToLch: F,
						xyzToLuv: A,
						luvToXyz: E,
						xyzToRgb: t,
						rgbToXyz: u,
						lchToRgb: O,
						rgbToLch: P,
					}
				})()

				const canvas = document.currentScript.parentElement
				var img = new Image(canvas.width, canvas.height)
				var canvasWidth = canvas.width
				const canvasHeight = canvas.height

				function getColorIndicesForCoord(x, y, width) {
					var red = y * (width * 4) + x * 4
					return [red, red + 1, red + 2, red + 3]
				}
				function getRandom() {
					return Math.floor(Math.random() * canvasWidth)
				}
				function getRandomCoord() {
					return { x: getRandom(), y: getRandom() }
				}

				// When true, moving the mouse draws on the canvas
				let isDrawing = false
				let x = 0
				let y = 0

				// event.offsetX, event.offsetY gives the (x,y) offset from the edge of the canvas.

				// Add the event listeners for mousedown, mousemove, and mouseup
				canvas.addEventListener('mousedown', e => {
					x = e.offsetX
					y = e.offsetY
					isDrawing = true
				})

				canvas.addEventListener('mousemove', e => {
					//  if (isDrawing === true) {
					//      draw();
					//    drawLine(ctx, x, y, e.offsetX, e.offsetY);

					x = e.offsetX
					y = e.offsetY
					//  }
				})

				canvas.addEventListener('mouseup', e => {
					if (isDrawing === true) {
						//    drawLine(ctx, x, y, e.offsetX, e.offsetY);
						x = 0
						y = 0
						isDrawing = false
					}
				})

				function drawLine(context, x1, y1, x2, y2) {
					ctx.beginPath()
					ctx.strokeStyle = 'black'
					ctx.lineWidth = 10
					ctx.moveTo(x1, y1)
					ctx.lineTo(x2, y2)
					ctx.stroke()
					ctx.closePath()
				}
				function init() {
					for (let i = 0; i < canvas.width * canvas.height * 4; i += 4) {
						const h = 360 * Math.random()
						const t = Math.random()
						let l = 32 * t + 87 * (1 - t)
						//                        l = 76;
						let s = 19
						s = 100 - Math.random() * 100

						let color = window.hsluv.lchToRgb([l, s, h])

						data[i] = Math.floor(color[0] * 256) // red
						data[i + 1] = Math.floor(color[1] * 256) // green
						data[i + 2] = Math.floor(color[2] * 256) // blue
						data[i + 3] = 255
					}
					ctx.drawImage(img, 0, 0, canvas.width, canvas.height)
					window.requestAnimationFrame(draw)
				}

				var ctx = canvas.getContext('2d')
				const imageData = ctx.getImageData(0, 0, canvasWidth, canvasWidth)
				const data = imageData.data
				let time = 0
				function draw() {
					time++
					const width = canvas.width
					const height = canvas.height
					//                ctx.globalCompositeOperation = 'destination-over';
					//                ctx.clearRect(0, 0, 300, 300); // clear canvas

					//                ctx.drawImage(img, 0, 0, 300, 300);
					//                count += 4;
					//var img = new Image();

					//var canvas = document.getElementById('canvas');
					//var ctx = canvas.getContext('2d');
					//ctx.drawImage(img, 0, 0);
					//                const imageData = ctx.createImageData(300, 300)
					//                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
					//                const data = imageData.data;
					for (let xx = 1; xx + 1 < canvasWidth; xx++) {
						for (let yy = 1; yy + 1 < canvasHeight; yy++) {
							//                                if (Math.random() < .5 + .5 * Math.cos(((-20*time + yy)%canvasWidth) / canvasWidth)) continue;
							if (Math.random() < 0.95) continue

							//                let count = getRandomCoord();
							const xxx = xx - x
							const yyy = yy - y
							const dist = Math.sqrt(xxx * xxx + yyy * yyy)
							let count = { xx, yy }
							//                                if (Math.random() * 800 > dist) continue;
							const dx = Math.floor(3 * Math.random() - 1)
							const dy = Math.floor(3 * Math.random() - 1)

							let count2 = { x: count.xx + dx, y: count.yy + dy }

							//                let x = count.x - count2.x;
							//                let y = count.y - count2.y;

							//                let dist = Math.sqrt(x*x + y*y)

							var colorIndices = getColorIndicesForCoord(
								count.xx,
								count.yy,
								canvasWidth
							)

							var redIndex = colorIndices[0]
							var greenIndex = colorIndices[1]
							var blueIndex = colorIndices[2]
							//var alphaIndex = colorIndices[3];

							const poo = getColorIndicesForCoord(
								count2.x,
								count2.y,
								canvasWidth
							)

							//                let b = Math.random()*300 < dist ? asdf[poo[0]] : asdf[redIndex];
							let b = data[poo[0]]

							//                const b = asdf[count] === asdf[count2] ? 255 - asdf[count] : 0;

							//                let b = Math.random();
							//                b = b > .5 ? 255 : 0;
							//                let b = 255;
							//                    asdf[redIndex]     = b;     // red
							//                    asdf[greenIndex] = b; // green
							//                    asdf[blueIndex] = b; // blue
							//                    asdf[count2]     = b;     // red
							//                    asdf[count2 + 1] = b; // green
							//                    asdf[count2 + 2] = b; // blue
							//                        if (data[redIndex] !== b){
							data[redIndex] = b // red
							data[greenIndex] = data[poo[0] + 1] // green
							data[blueIndex] = data[poo[0] + 2] // blue
							//                    data[count2]     = b;     // red
							//                    data[count2 + 1] = b; // green
							//                    data[count2 + 2] = b; // blue

							//                for (let i = 0; i < data.length; i += 4){
							//                    data[i]     = asdf[i];     // red
							//                    data[i + 1] = asdf[i+1]; // green
							//                    data[i + 2] = asdf[i+2]; // blue
							//                    data[i+3] = 255
							//                }

							//                        }
							//                ctx.drawImage()
							//                count += 4;
						}
					}
					ctx.putImageData(imageData, 0, 0)

					window.requestAnimationFrame(draw)
				}

				init()
			</script>
		</canvas>
	</body>
</html>
